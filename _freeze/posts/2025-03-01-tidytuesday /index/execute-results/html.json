{
  "hash": "52f1c4bf051fea592f4b226258101999",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"TidyTuesday: Long Beach Animal Shelter\"\ndescription: \"\"\nauthor:\n  - name: Jess Graves\ndate: 03-01-2025\neditor: visual\nexecute-dir: project\ncrossref:\n  fig-title: '**Figure**'\n  tbl-title: '**Table**'\n  fig-labels: arabic\n  tbl-labels: arabic\n  title-delim: \".\"\nlink-citations: true\nexecute:\n  echo: true\n  warning: false\n  message: false\ncategories: [tidy tuesday, data visualization] # self-defined categories\nimage: preview-image.png\ndraft: false  \n# bibliography: references.bib\nnocite: |\n  @*\n# csl: statistics-in-biosciences.csl\nbibliographystyle: apa\ncitation: true\n---\n\n\n\n# This week's dataset (2025-03-04)\n\nThis week's tidytuesday included a published dataset from Long Beach Animal Shelter. Here's what their [README](https://github.com/rfordatascience/tidytuesday/tree/main/data/2025/2025-03-04) says:\n\n::: {.callout-note appearance=\"minimal\"}\nThis week we're exploring the [Long Beach Animal Shelter Data](https://data.longbeach.gov/explore/dataset/animal-shelter-intakes-and-outcomes/information/)!\n\nThe dataset comes from the [City of Long Beach Animal Care Services](https://www.longbeach.gov/acs/) via the [{animalshelter}](https://emilhvitfeldt.github.io/animalshelter/) R package.\n\n> This dataset comprises of the intake and outcome record from Long Beach Animal Shelter.\n\n-   How has the number of pet adoptions changed over the years?\n\n-   Which type of pets are adopted most often?\n:::\n\n## What I hope to visualize\n\n-   What pets are represented in the dataset?\n\n-   What outcomes are most likely to occur in different pets?\n\n-   Have visit rates changed over time?\n\n# Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Libraries\"}\nlibrary(tidyverse)\nlibrary(styler)\nlibrary(patchwork)\nlibrary(ggmosaic)\nlibrary(colorspace)\nlibrary(paletteer)\nlibrary(ggstream)\nlibrary(gtsummary)\n\n# c1 <- \"#FDFBE4FF\"\nc2 <- lighten(\"#FFFBF2\", amount = 0.3)\n\nchoice <- c2\n# setting ggplot theme\nmy_theme <- theme_classic() +\n  theme(\n    axis.title = element_text(size = 16, color = \"grey30\", \n                              face = \"bold\"),\n    axis.text = element_text(size = 14, color = \"grey30\"),\n    axis.line = element_line(color = \"grey50\"),\n    strip.text = element_text(size = 14),\n    plot.background = element_rect(\n      color =  choice,\n      fill = choice\n    ),\n    panel.background = element_rect(\n      color = choice,\n      fill = choice\n    )\n  ) \n\npalette <- \"lisa::FridaKahlo\"\nalpha = 0.9\n\ntheme_set(my_theme)\ntoday <- Sys.Date()\n\nlongbeach <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-03-04/longbeach.csv') \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Tabulating animal types and outcome types\"}\nlongbeach %>% \n  dplyr::select(animal_type, outcome_type)  %>%\n  tbl_summary()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"qhomycevli\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qhomycevli table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qhomycevli thead, #qhomycevli tbody, #qhomycevli tfoot, #qhomycevli tr, #qhomycevli td, #qhomycevli th {\n  border-style: none;\n}\n\n#qhomycevli p {\n  margin: 0;\n  padding: 0;\n}\n\n#qhomycevli .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qhomycevli .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qhomycevli .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qhomycevli .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qhomycevli .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qhomycevli .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qhomycevli .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qhomycevli .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qhomycevli .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qhomycevli .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qhomycevli .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qhomycevli .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qhomycevli .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qhomycevli .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qhomycevli .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qhomycevli .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qhomycevli .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qhomycevli .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qhomycevli .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qhomycevli .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qhomycevli .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qhomycevli .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qhomycevli .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qhomycevli .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qhomycevli .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qhomycevli .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qhomycevli .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qhomycevli .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qhomycevli .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qhomycevli .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qhomycevli .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qhomycevli .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qhomycevli .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qhomycevli .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qhomycevli .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qhomycevli .gt_left {\n  text-align: left;\n}\n\n#qhomycevli .gt_center {\n  text-align: center;\n}\n\n#qhomycevli .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qhomycevli .gt_font_normal {\n  font-weight: normal;\n}\n\n#qhomycevli .gt_font_bold {\n  font-weight: bold;\n}\n\n#qhomycevli .gt_font_italic {\n  font-style: italic;\n}\n\n#qhomycevli .gt_super {\n  font-size: 65%;\n}\n\n#qhomycevli .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qhomycevli .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qhomycevli .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qhomycevli .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qhomycevli .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qhomycevli .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qhomycevli .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qhomycevli .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qhomycevli div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"PHN0cm9uZz5DaGFyYWN0ZXJpc3RpYzwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_0\"><span data-qmd-base64=\"PHN0cm9uZz5OID0gMjksNzg3PC9zdHJvbmc+\"><span class='gt_from_md'><strong>N = 29,787</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">animal_type</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    amphibian</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">3 (&lt;0.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    bird</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">2,075 (7.0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    cat</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">14,145 (47%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    dog</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">9,768 (33%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    guinea pig</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">172 (0.6%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    livestock</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">10 (&lt;0.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1,332 (4.5%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    rabbit</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">526 (1.8%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    reptile</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">344 (1.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    wild</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1,412 (4.7%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">outcome_type</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    adoption</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">6,290 (21%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    community cat</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">386 (1.3%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    died</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">763 (2.6%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    disposal</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">71 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    duplicate</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">31 (0.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    euthanasia</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">5,451 (18%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    foster</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">10 (&lt;0.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    foster to adopt</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">166 (0.6%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    homefirst</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">88 (0.3%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    missing</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">59 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    rescue</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">6,680 (23%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    return to owner</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">3,214 (11%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    return to rescue</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">46 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    return to wild habitat</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">294 (1.0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    shelter, neuter, return</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">919 (3.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    transfer</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">4,869 (16%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    transport</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">206 (0.7%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    trap, neuter, release</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">57 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Unknown</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">187</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"biAoJSk=\"><span class='gt_from_md'>n (%)</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nThere seem to be some redundant outcome types, so I am going to combine a few categories\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlongbeach <- longbeach %>%\n  filter(animal_type !='other', \n         outcome_type != 'duplicate')  %>%\n  mutate(age = difftime(intake_date, dob, units='days')/365.25, \n         outcome_type_clean = case_when(grepl('neuter', outcome_type) ~ 'neuter', \n                                        grepl('return', outcome_type) ~ 'return', \n                                        grepl('foster', outcome_type) ~ 'foster', \n                                        grepl('disposal', outcome_type) ~ 'died', \n                                        TRUE ~ outcome_type )) %>%\n  mutate(across(c(outcome_type_clean, animal_type), str_to_sentence))\n```\n:::\n\n\n\nFor the sake of de-cluttering, I'm only going to look at the top 5 most frequent pets and top 5 most frequent outcome types.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Top 5 most frequent pets and outcomes\"}\nanimal_levels <- longbeach %>%\n  group_by(animal_type) %>%\n  tally() %>%\n  arrange(desc(n)) %>%\n  slice(1:5)\n\noutcome_levels <-longbeach %>%\n  group_by(outcome_type_clean) %>%\n  tally() %>%\n  arrange(desc(n)) %>%\n  slice(1:5)\n```\n:::\n\n\n\n# Most frequent visits & outcome types\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_clean <- longbeach %>%\n  filter(animal_type %in% animal_levels$animal_type, \n         outcome_type_clean %in% outcome_levels$outcome_type_clean) %>%\n  mutate(animal_type = factor(animal_type, \n                              levels = animal_levels$animal_type), \n         outcome_type_clean = factor(outcome_type_clean, \n                              levels = outcome_levels$outcome_type_clean), \n         )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_mosaic <- data_clean %>%\n  ggplot() +\n  geom_mosaic(aes(x=product(outcome_type_clean), \n                  fill=animal_type), \n              offset=0.001, alpha=alpha)+\n  theme(legend.position ='none', \n        axis.text.x= element_blank(), \n        axis.ticks = element_blank(), \n        axis.title.x = element_blank(),\n        axis.title.y = element_text(margin=margin(r=5, \n                                                  l=5))) + \n  scale_x_productlist(expand=c(0, 0)) + \n  scale_y_productlist(expand=c(0, 0)) + \n  coord_flip() + \n  labs(y='Pet', x='Visit outcome') +\n  scale_fill_paletteer_d(palette)  \np_mosaic\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_hist <- data_clean %>% \n  group_by(animal_type) %>% \n  tally() %>% \n  mutate(percent = paste0(round(100*n/sum(n), 0), '%'), \n         n_pct = paste0(format(n, big.mark = ','), ' (', percent, ')')) %>%\n  ggplot(aes(x=animal_type, y=n, fill=animal_type)) + \n  geom_bar(stat='identity', \n           alpha=alpha) +\n  scale_fill_paletteer_d(palette) + \n  guides(fill = 'none') + \n  geom_text(aes(label = n_pct, y = n), \n            vjust = -1, \n            color = 'grey30', \n            size=4.5) + \n  theme(axis.line = element_blank(), \n        axis.text.y = element_blank(), \n        axis.title = element_blank(), \n        axis.ticks = element_blank(), \n        axis.text.x = element_text(vjust=5), \n        plot.title = element_text(size=18, color = 'grey30', \n                                  hjust=1)) + \n  scale_y_continuous(limits = c(0, 13000)) \np_hist\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n# Number of adoptions over time\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_stream <- data_clean %>%\n  filter(outcome_type_clean == 'Adoption') %>%\n  mutate(year_mo = floor_date(intake_date, \"month\")) %>%\n  group_by(year_mo, animal_type) %>%\n  tally() %>% \n  mutate(animal_type = factor(animal_type, levels = animal_levels$animal_type)) %>%\n  ggplot(aes(x=year_mo, \n             y = n, \n             fill=animal_type)) + \n  geom_stream(alpha=alpha) +\n  scale_fill_paletteer_d(palette, drop = FALSE) + \n  scale_x_date(date_breaks = \"1 year\", \n               date_labels = '%Y', \n               expand = c(0, 0)) + \n  theme(axis.text.y=element_blank(), \n        axis.ticks=element_blank(), \n        axis.line.y=element_blank()) + \n  labs(x='Year', y='Number of adoptions') + \n  guides(fill = FALSE)\np_stream\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n# Combining\n\n## Version 1\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_bottom <- (p_hist + plot_spacer() + p_mosaic + theme(axis.title.y=element_blank())) + \n    plot_layout(nrow = 1, widths = c(2, 0.1, 1))\n(p_stream / p_bottom )+ \n  plot_layout(nrow=2, \n              heights = c(1, 0.5))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n\n## Version 2 (Final version)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nright_side <- (p_hist +\n    theme(axis.text.x = element_text(vjust=1))) /\n  (p_mosaic) +\n  plot_layout(ncol = 1, \n              heights = c(1, 1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal <- (p_stream | right_side) + plot_layout(widths = c(2.5, 1.1))+ \n  plot_annotation(title = 'Long Beach Animal Shelter', \n                  caption = 'Data from: Long Beach Animal Shelter (tidytuesday Week 8); Vis by: github.com/jesslgraves') & \n  theme(plot.title = element_text(size=28, face = 'bold'))\n\nfinal \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=1632}\n:::\n\n```{.r .cell-code}\nggsave('preview-image.png', final, \n       units='cm', \n       width = 50, \n       height = 25)\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}