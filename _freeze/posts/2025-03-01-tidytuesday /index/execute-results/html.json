{
  "hash": "35d27b148bfcaae4a037cda5427fba24",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Understanding Martin Bland's 'Deceting a single event'\"\ndescription: \"Exploring the math behind the method.\"\nauthor:\n  - name: Jess Graves\ndate: 03-10-2025\nexecute-dir: project\ncrossref:\n  fig-title: '**Figure**'\n  tbl-title: '**Table**'\n  fig-labels: arabic\n  tbl-labels: arabic\n  title-delim: \".\"\nlink-citations: true\nexecute:\n  echo: true\n  warning: false\n  message: false\ncategories: [tidy tuesday, data visualization] # self-defined categories\nimage: preview-image.png\ndraft: true  \n# bibliography: references.bib\nnocite: |\n  @*\n# csl: statistics-in-biosciences.csl\nbibliographystyle: apa\ncitation: true\n---\n\n\n\n# Intro\n\nI recently came across this document (white paper??) by Marin Bland called '[Detecting a single event](https://www-users.york.ac.uk/~mb55/bsi_study/single_event.pdf)', and wanted to learn more about the method behind the math. I don't often get to sink back into stats theory, and this is a approachable method.\n\nIn it, he says:\n\n::: {.callout-note appearance=\"minimal\"}\nThe problem is this. If we have a series of cases where no event has taken place, what is the estimated event rate? ...\\\n\\\nJust because we have not seen an event yet does not mean we will never see one.\n:::\n\nWhat he tries to provide us with is a sense of certainty around what isn't directly observed.\n\nSay, for example, I want to study the likelihood that a rare negative outcome may occur in my study. I want to enroll a certain amount of participants. But, because the event is rare, there is a fair chance that I will simply see no events at all during the study ‚Äì because that's how probability rolls (ü•Å).\n\n# Rare events are hard to capture ....\n\nJust because I didn't see it just because it isn't there! So.... what could it have been?\n\nLet's say we know an event is likely to occur 1% of the time. Would it make sense to run a study in 5 participants? No. This is intuitive, because even under percectly average conditions, 1% of 5 is still \\< 1, and we will never see less than 1 person obtain an event. What about N = 100? We *might* get 1 event! But.... we might not. But it feels reasonable to believe that a study of N = 100 could have 0 events and still reflect a 1% incidence rate. But does 0 events out of 100 participants feel reasonable for a 10% incidence rate???\n\n## How do we quantify \"enough\"?\n\nSo, there are two ways to frame this as questions:\n\n1.  I have N participants in my study, and I saw 0 events, what is the range of incidence rates that are *reasonable* for me assume I've captured?\n2.  I want to run a study, what number of participants do I need to enroll to maximize my likelihood of observing an event?\n\nTo understand the method, we should revisit the binomial distribution.\n\n# The Binomial Distribution\n\nThe binomial distribution provides an estimate of the probability a total number of *n* independent events occur. For example, if I flip a coin 6 times, how many of them will land on heads? On average, half of the flips will be heads. Or, to generalize, total number of attempts \\* the probability that the coin will land on heads (p=0.50, 50/50), $n_{trials}*p(heads) = 6*0.5 = 3$ .\n\nIf I want to ask, what is the probability that I will see 3 heads *in a row*, [probability theory](https://en.wikipedia.org/wiki/Independence_(probability_theory)) says that the likelihood of two independent events occuring together is the multiplication of their probabilities, so in this case $p(heads)*p(heads)*p(heads)=p(heads)^3$ .\n\nThe[probability density function](https://en.wikipedia.org/wiki/Binomial_distribution) is a way to reliably estimate these. For the binomial distribution this is:\n\n$$\np(X = k) =     \\binom{n}{k} p^k(1-p)^{n-k}\n$$\n\nThat is, the probability that you will see $k$ number of successes out of $n$ total attempts, where the probability of that event occurring is $p$ (and the probability of that event *not* occurring is $1-p$ .\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(paletteer)\npal <- \"lisa::OskarSchlemmer\"\n# pal <- \"beyonce::X6\"\n# pal <- \"LaCroixColoR::Orange\"\n\nmy_theme <- theme_classic() + \n  theme(axis.text = element_text(size=12), \n        axis.title = element_text(size=14), \n        legend.text = element_text(size=12), \n        legend.title = element_text(size=14), \n        panel.background = element_rect(color = '#273649FF', fill = \"#273649FF\"), \n        plot.background = element_rect(color = \"#273649FF\", fill = \"#273649FF\"), \n        legend.background = element_rect(color = \"#273649FF\", fill = \"#273649FF\")\n        # panel.background = element_rect(color = '#E1E1E1FF'), \n        # plot.background = element_rect(color = \"#E1E1E1FF\"), \n        )\n\ntheme_set(my_theme)\n\nns <- seq(10, 50, by=10)\nks <- c(0:50)\np <- 0.5\n\nexamples <- crossing(k=ks, n=ns, p) %>%\n  filter(k <= n) %>%\n  rowwise() %>%\n  mutate(prob_k = dbinom(k, n, p)) \n\nexamples %>% \n  ggplot(aes(x=k, y=prob_k, color = factor(n))) + \n  geom_line() + \n  labs(x='K succeses out of N', \n       y = 'P(x=K)', \n       color = 'Total N') + \n  scale_color_paletteer_d(palette = pal)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}