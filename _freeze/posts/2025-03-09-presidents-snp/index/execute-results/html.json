{
  "hash": "45b73a62f82a167296ec35d9ae244904",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"How has the market historically responded to the first 2 months of a president's term?\"\ndescription: \"Using {quantmod} & {gganimate} to explore market changes under recent presidents.\"\nauthor:\n  - name: Jess Graves\ndate: 03-09-2025\nexecute-dir: project\ncrossref:\n  fig-title: '**Figure**'\n  tbl-title: '**Table**'\n  fig-labels: arabic\n  tbl-labels: arabic\n  title-delim: \".\"\nlink-citations: true\nexecute:\n  echo: true\n  warning: false\n  message: false\ncategories: [animated figure, data visualization] # self-defined categories\nimage: preview-image.png\ndraft: false  \n# bibliography: references.bib\nnocite: |\n  @*\n# csl: statistics-in-biosciences.csl\nbibliographystyle: apa\ncitation: true\n---\n\n\n\n\n\n# How does Trump's first 8 weeks compare to other recent presidents?\n\nIt's no secret that the market ain't looking so hot under President Trump so far. Who's all saying it:\n\n-   [CNN](https://www.cnn.com/2025/03/08/politics/trump-whiplash-tariffs-ukraine-musk/index.html): \"Trump’s week of whiplash rattles markets, allies and his own administration\"\n\n-   [CNBC](https://www.cnbc.com/2025/03/06/trump-says-hes-not-even-looking-at-stock-market.html): \"Trump says he’s not even looking at stock market, tariffs will make U.S. ‘very strong’\"\n\n-   [Business Insider](https://www.businessinsider.com/trump-deregulation-policy-tariffs-market-crypto-antitrust-enforcement-gdp-growth-2025-3): \"It's not just tariff anxiety. The market's whole bull case under Trump has been turned on its head.\"\n\n-   [NBC](https://www.nbcnews.com/business/markets/stocks-fall-even-trump-gives-mexico-one-month-reprieve-tariffs-rcna195160): \"Stocks fall as markets grapple with Trump's rapid shifts in tariff policy\"\n\nBut, based on what my not-very-tenured memory can recall, a lot of presidents have suffered market volatility during the start of their terms. But, I had no data to back that up. So...\n\nI thought this was a great opportunity to try to:\n\n1.  Look at and track down data I don't usually interact with (market data, politics)\n2.  Practice data vis skills\n3.  Learn how to use {[gganimate](https://gganimate.com)}!\n    -   Surprise! I had issues getting this to export, but using {[gifski](https://cran.r-project.org/web/packages/gifski/index.html)} to render ended up resolving my issue.\n\n# The data\n\n## Presidential data\n\nI have two datasets to work with:\n\n1.  The [`presidential`](https://ggplot2.tidyverse.org/reference/presidential.html?q=presidential#ref-usage) dataset from {[`ggplot2`](https://ggplot2.tidyverse.org)}\n    -   The `data(presidential)` has the start and end dates for every president since Eisenhower and their party affiliation\n2.  S&P 500 data from {[`quantmod`](https://www.quantmod.com)}\n    -   This scrapes financial data during a user-specified time frame -– I chose 1980 and on. You can choose any stock or index you're interested in. I've chosen to use the S&P 500, which is labeled as `^GSPC` (I don't know why because I don't know anything about \"the market\" really, but that's just how it is).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Libraries & themes\"}\nlibrary(tidyverse)\nlibrary(quantmod)\nlibrary(patchwork)\nlibrary(data.table)\nlibrary(colorspace)\nlibrary(ggrepel)\nlibrary(gganimate)\n# library(gifski) # can't call this due to environment issues\nlibrary(gt)\n\nbackground <- \"#FBF7F2\"\ntext <- \"#5C4033\"\ntext_size <- 14\ntitle_size <- 16\n\nmy_theme <- theme_classic() +\n  theme(\n    axis.text = element_text(size = text_size, color = text),\n    axis.title.y = element_text(\n      size = title_size, face = \"bold\", color = text,\n      margin = margin(0, 10, 0, 10)\n    ),\n    axis.title.x = element_text(\n      size = title_size, face = \"bold\", color = text,\n      margin = margin(10, 0, 10, 0)\n    ),\n    axis.line = element_line(color = text),\n    axis.ticks = element_blank(),\n    legend.text = element_text(size = text_size, color = text),\n    legend.title = element_text(size = text_size, color = text),\n    panel.background = element_rect(\n      fill = background,\n      color = background\n    ),\n    plot.background = element_rect(\n      fill = background,\n      color = background\n    ),\n    plot.title = element_text(size = 20, face = \"bold\", color = text),\n    legend.background = element_rect(\n      fill = background,\n      color = background\n    )\n  )\n\ntheme_set(my_theme)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(gt)\ndata(presidential) # from ggplot2\npresidential %>% gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nvkcdjfedo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nvkcdjfedo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nvkcdjfedo thead, #nvkcdjfedo tbody, #nvkcdjfedo tfoot, #nvkcdjfedo tr, #nvkcdjfedo td, #nvkcdjfedo th {\n  border-style: none;\n}\n\n#nvkcdjfedo p {\n  margin: 0;\n  padding: 0;\n}\n\n#nvkcdjfedo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nvkcdjfedo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nvkcdjfedo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nvkcdjfedo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nvkcdjfedo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nvkcdjfedo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nvkcdjfedo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nvkcdjfedo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nvkcdjfedo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nvkcdjfedo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nvkcdjfedo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nvkcdjfedo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nvkcdjfedo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nvkcdjfedo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nvkcdjfedo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nvkcdjfedo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nvkcdjfedo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nvkcdjfedo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nvkcdjfedo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nvkcdjfedo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nvkcdjfedo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nvkcdjfedo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nvkcdjfedo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nvkcdjfedo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nvkcdjfedo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nvkcdjfedo .gt_left {\n  text-align: left;\n}\n\n#nvkcdjfedo .gt_center {\n  text-align: center;\n}\n\n#nvkcdjfedo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nvkcdjfedo .gt_font_normal {\n  font-weight: normal;\n}\n\n#nvkcdjfedo .gt_font_bold {\n  font-weight: bold;\n}\n\n#nvkcdjfedo .gt_font_italic {\n  font-style: italic;\n}\n\n#nvkcdjfedo .gt_super {\n  font-size: 65%;\n}\n\n#nvkcdjfedo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nvkcdjfedo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nvkcdjfedo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nvkcdjfedo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nvkcdjfedo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nvkcdjfedo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nvkcdjfedo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#nvkcdjfedo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#nvkcdjfedo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name\">name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"start\">start</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"end\">end</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"party\">party</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Eisenhower</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1953-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1961-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Kennedy</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1961-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1963-11-22</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Johnson</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1963-11-22</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1969-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Nixon</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1969-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1974-08-09</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Ford</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1974-08-09</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1977-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Carter</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1977-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1981-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Reagan</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1981-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1989-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Bush</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1989-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1993-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Clinton</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1993-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2001-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Bush</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2001-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2009-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Obama</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2009-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2017-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_left\">Trump</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2017-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2021-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\nNotably, the dataset is missing some features I care about:\n\n1.  It stops at Trump's 1st term (2021)\n2.  It doesn't separate out 2nd terms\n\nSo, I had to manually enter the rest of the data myself. Open this code fold at your own risk, it's not pretty.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Beware! manual data cleaning\"}\npresidential <- presidential %>%\n  arrange(start) %>%\n  rbind(\n    .,\n    tibble(\n      name = c(\n        \"Obama 2nd\",\n        \"Biden\",\n        \"Trump\",\n        \"Bush Jr. 2nd\",\n        \"Clinton 2nd\"\n      ),\n      start = as.Date(c(\n        \"2013-01-20\",\n        \"2021-01-20\",\n        \"2025-01-20\",\n        \"2005-01-20\",\n        \"1997-01-20\"\n      )),\n      end = as.Date(c(\n        \"2017-01-20\",\n        \"2025-01-20\", NA,\n        \"2009-01-20\",\n        \"2001-01-20\"\n      )),\n      party = c(\n        \"Democratic\",\n        \"Democratic\",\n        \"Republican\",\n        \"Republican\",\n        \"Democratic\"\n      )\n    )\n  )\n\npresidential$name[presidential$name == \"Bush\"] <- c(\"Bush Sr.\", \"Bush Jr. 1st\")\npresidential$name[presidential$name == \"Trump\"] <- c(\"Trump 1st\", \"Trump 2nd\")\npresidential$name[presidential$name == \"Clinton\"] <- c(\"Clinton 1st\")\npresidential$name[presidential$name == \"Obama\"] <- c(\"Obama 1st\")\npresidential$end[presidential$name == \"Clinton 1st\"] <- as.Date(\"1997-01-20\")\npresidential$end[presidential$name == \"Obama 1st\"] <- as.Date(\"2013-01-20\")\npresidential$end[presidential$name == \"Bush Jr. 2nd\"] <- as.Date(\"2009-01-20\")\n\npresidential <- presidential %>% arrange(start)\n\npresidential$name <- factor(presidential$name,\n  levels = presidential$name\n)\n```\n:::\n\n::: {#tbl-data .cell tbl-cap='Final presidential dataset'}\n\n```{.r .cell-code}\npresidential %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"zwypaivuvw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zwypaivuvw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zwypaivuvw thead, #zwypaivuvw tbody, #zwypaivuvw tfoot, #zwypaivuvw tr, #zwypaivuvw td, #zwypaivuvw th {\n  border-style: none;\n}\n\n#zwypaivuvw p {\n  margin: 0;\n  padding: 0;\n}\n\n#zwypaivuvw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zwypaivuvw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zwypaivuvw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zwypaivuvw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zwypaivuvw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zwypaivuvw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zwypaivuvw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zwypaivuvw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zwypaivuvw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zwypaivuvw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zwypaivuvw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zwypaivuvw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zwypaivuvw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zwypaivuvw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zwypaivuvw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwypaivuvw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zwypaivuvw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zwypaivuvw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zwypaivuvw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwypaivuvw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zwypaivuvw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwypaivuvw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zwypaivuvw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwypaivuvw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zwypaivuvw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwypaivuvw .gt_left {\n  text-align: left;\n}\n\n#zwypaivuvw .gt_center {\n  text-align: center;\n}\n\n#zwypaivuvw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zwypaivuvw .gt_font_normal {\n  font-weight: normal;\n}\n\n#zwypaivuvw .gt_font_bold {\n  font-weight: bold;\n}\n\n#zwypaivuvw .gt_font_italic {\n  font-style: italic;\n}\n\n#zwypaivuvw .gt_super {\n  font-size: 65%;\n}\n\n#zwypaivuvw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zwypaivuvw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zwypaivuvw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zwypaivuvw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zwypaivuvw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zwypaivuvw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zwypaivuvw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zwypaivuvw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zwypaivuvw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name\">name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"start\">start</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"end\">end</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"party\">party</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Eisenhower</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1953-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1961-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Kennedy</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1961-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1963-11-22</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Johnson</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1963-11-22</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1969-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Nixon</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1969-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1974-08-09</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Ford</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1974-08-09</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1977-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Carter</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1977-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1981-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Reagan</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1981-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1989-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Bush Sr.</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1989-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1993-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Clinton 1st</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1993-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">1997-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Clinton 2nd</td>\n<td headers=\"start\" class=\"gt_row gt_right\">1997-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2001-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Bush Jr. 1st</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2001-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2009-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Bush Jr. 2nd</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2005-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2009-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Obama 1st</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2009-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2013-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Obama 2nd</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2013-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2017-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Trump 1st</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2017-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2021-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Biden</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2021-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">2025-01-20</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Democratic</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Trump 2nd</td>\n<td headers=\"start\" class=\"gt_row gt_right\">2025-01-20</td>\n<td headers=\"end\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"party\" class=\"gt_row gt_left\">Republican</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\nNow, I will need to match dates within the market data to each president's terms.\n\nTo do this, I will expand the presidential data into a long format where there is a single column of the sequential dates in each term. I'm going to write a custom function to help me out here.\n\n(🤔 In retrospect, I did not need to write this function because there are no gaps between terms... but alas, this problem generalizes to other messier data like these, so will include in case its helpful to anyone reading).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Function to generate date sequences for each president\nexpand_dates <- function(start_date, end_date) {\n  # If the end date is NA, use today's date\n  if (is.na(end_date)) {\n    end_date <- Sys.Date()\n  }\n  # Generate the sequence of dates\n  seq(start_date, end_date, by = \"day\")\n}\n\n# Expand the data frame\nexpanded_df <- presidential %>%\n  rowwise() %>%\n  mutate(date = list(expand_dates(start, end))) %>%\n  unnest(date) %>%\n  ungroup()\n```\n:::\n\n::: {#tbl-expanded-data .cell tb-cap='Example rows of expanded dataset'}\n\n```{.r .cell-code}\nexpanded_df %>% \n  dplyr::select(name, party, date) %>% \n  filter(name %in% c('Eisenhower', 'Kennedy')) %>%\n  group_by(name) %>%\n  slice(1:5) %>% \n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"zlfgahjcre\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zlfgahjcre table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zlfgahjcre thead, #zlfgahjcre tbody, #zlfgahjcre tfoot, #zlfgahjcre tr, #zlfgahjcre td, #zlfgahjcre th {\n  border-style: none;\n}\n\n#zlfgahjcre p {\n  margin: 0;\n  padding: 0;\n}\n\n#zlfgahjcre .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zlfgahjcre .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zlfgahjcre .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zlfgahjcre .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zlfgahjcre .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zlfgahjcre .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zlfgahjcre .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zlfgahjcre .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zlfgahjcre .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zlfgahjcre .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zlfgahjcre .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zlfgahjcre .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zlfgahjcre .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zlfgahjcre .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zlfgahjcre .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zlfgahjcre .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zlfgahjcre .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zlfgahjcre .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zlfgahjcre .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zlfgahjcre .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zlfgahjcre .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zlfgahjcre .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zlfgahjcre .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zlfgahjcre .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zlfgahjcre .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zlfgahjcre .gt_left {\n  text-align: left;\n}\n\n#zlfgahjcre .gt_center {\n  text-align: center;\n}\n\n#zlfgahjcre .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zlfgahjcre .gt_font_normal {\n  font-weight: normal;\n}\n\n#zlfgahjcre .gt_font_bold {\n  font-weight: bold;\n}\n\n#zlfgahjcre .gt_font_italic {\n  font-style: italic;\n}\n\n#zlfgahjcre .gt_super {\n  font-size: 65%;\n}\n\n#zlfgahjcre .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zlfgahjcre .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zlfgahjcre .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zlfgahjcre .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zlfgahjcre .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zlfgahjcre .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zlfgahjcre .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zlfgahjcre .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zlfgahjcre div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"party\">party</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"date\">date</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Eisenhower\">Eisenhower</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"Eisenhower  party\" class=\"gt_row gt_left\">Republican</td>\n<td headers=\"Eisenhower  date\" class=\"gt_row gt_right\">1953-01-20</td></tr>\n    <tr><td headers=\"Eisenhower  party\" class=\"gt_row gt_left\">Republican</td>\n<td headers=\"Eisenhower  date\" class=\"gt_row gt_right\">1953-01-21</td></tr>\n    <tr><td headers=\"Eisenhower  party\" class=\"gt_row gt_left\">Republican</td>\n<td headers=\"Eisenhower  date\" class=\"gt_row gt_right\">1953-01-22</td></tr>\n    <tr><td headers=\"Eisenhower  party\" class=\"gt_row gt_left\">Republican</td>\n<td headers=\"Eisenhower  date\" class=\"gt_row gt_right\">1953-01-23</td></tr>\n    <tr><td headers=\"Eisenhower  party\" class=\"gt_row gt_left\">Republican</td>\n<td headers=\"Eisenhower  date\" class=\"gt_row gt_right\">1953-01-24</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Kennedy\">Kennedy</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"Kennedy  party\" class=\"gt_row gt_left\">Democratic</td>\n<td headers=\"Kennedy  date\" class=\"gt_row gt_right\">1961-01-20</td></tr>\n    <tr><td headers=\"Kennedy  party\" class=\"gt_row gt_left\">Democratic</td>\n<td headers=\"Kennedy  date\" class=\"gt_row gt_right\">1961-01-21</td></tr>\n    <tr><td headers=\"Kennedy  party\" class=\"gt_row gt_left\">Democratic</td>\n<td headers=\"Kennedy  date\" class=\"gt_row gt_right\">1961-01-22</td></tr>\n    <tr><td headers=\"Kennedy  party\" class=\"gt_row gt_left\">Democratic</td>\n<td headers=\"Kennedy  date\" class=\"gt_row gt_right\">1961-01-23</td></tr>\n    <tr><td headers=\"Kennedy  party\" class=\"gt_row gt_left\">Democratic</td>\n<td headers=\"Kennedy  date\" class=\"gt_row gt_right\">1961-01-24</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n## Market data\n\nHere I use `getSymbol()` from the {`quantmod`} package to get S&P 500 data, starting from `1980-01-01`, because I am not a masochist.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\ngspc <- getSymbols(\"^GSPC\",\n  auto.assign = FALSE,\n  from = \"1980-01-01\"\n)\n```\n:::\n\n\n\n\n\nThis data didn't need much cleaning, but I did notice that the `gspc` object doesn't have traditional `row.names`–instead you need to use `index()` if you want to extract the dates in the rows.\n\nI also need to generate a variable where presidents will have their party colors when plotted, with the added detail that more recent presidents have darker shades of that color.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Cleaning up the data and merging in president information\"}\ngspc2 <- as_tibble(gspc)\ngspc2$date <- as.Date(index(gspc))\n\nexpanded_gspc <- gspc2 %>%\n  dplyr::select(GSPC.Close, date) %>%\n  left_join(., expanded_df %>%\n    dplyr::select(name, party, date, start) %>%\n    rename(start_of_term = start))\n\nrecent_pres <- expanded_gspc %>%\n  filter(start_of_term >= min(gspc2$date)) %>%\n  mutate(gspc_log = log(GSPC.Close)) %>%\n  group_by(name) %>%\n  # creating a variable that will be used to have party colors where more recent terms have darker values\n  mutate(\n    time = as.numeric(as.Date(\"1970-01-01\") - start_of_term),\n    time_party = if_else(party == \"Republican\",\n      -1 * time / 150, # re-scaling\n      time / 200\n    )\n  ) \n```\n:::\n\n\n\n\n\n# The market since 1980\n\nLet's just get a sense of what \"the market\" has done over the last 45 years.\n\nIt's generally increased over time. We can see that the recession that plagued Bush after Clinton left office, and the post-Bush Jr & into Obama recession \\~ 2009 (yay! that was when I graduated college and entered *the workforce*.) COVID related dips in the 2020s were brief, but pretty dramatic.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"plot code\"}\n# label dataset\npres_labels <- recent_pres %>%\n  group_by(name, start_of_term, time_party) %>%\n  arrange(name, start_of_term) %>%\n  summarize(y.position = first(GSPC.Close)) \n\n# Figure\nsnp_over_time <- recent_pres %>%\n  ggplot(aes(\n    x = date,\n    y = log(GSPC.Close),\n    color = time_party,\n    group = name\n  )) +\n  geom_line(linewidth = 1.5) +\n  scale_x_date( # expand=c(0, 0),\n    date_breaks = \"4 years\",\n    date_labels = \"%Y\"\n  ) +\n  scale_y_continuous(\n    breaks = scales::pretty_breaks(10),\n    # limits = c(-300, 150)\n  ) +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"\",\n    y = \"S&P 500 at closing\\n(natural log scaled)\",\n    color = \"\",\n    title = \"S&P 500 since 1980\"\n  ) +\n  scale_color_continuous_diverging(\n    palette = \"Blue-Red\",\n    l1 = 20, l2 = 90,\n    p1 = 1, p2 = 1,\n    alpha = 1\n  ) +\n  geom_label_repel(\n    data = pres_labels,\n    aes(\n      x = start_of_term,\n      y = log(y.position),\n      label = name,\n      color = time_party\n    ),\n    nudge_y = .75,\n    max.overlaps = 10\n  )\n\nsnp_over_time\n\nggsave(\"preview-image.png\", snp_over_time,\n  units = \"cm\",\n  height = 30*.6,\n  width = 30\n)\n```\n\n::: {.cell-output-display}\n![S&P 500 since 1980 to today (natural log scale used to improve readabilty)](index_files/figure-html/fig-snp-over-time-1.png){#fig-snp-over-time width=960}\n:::\n:::\n\n\n\n\n\n# Changes in market data\n\nTrump's been in office for almost 2 months, so I'll be looking at the first 8 weeks of data for every president since 1980.\n\nOverall, the first 8 weeks in Trump's 2nd term have shown the hardest falls in S&P 500 value compared to any of the presidents here. 2nd in the running is Bush Jr.'s 1st term, followed by Obama's 1st term.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweeks_in_office <- 8\n\nfrom_start <- recent_pres %>%\n  group_by(name) %>%\n  arrange(date) %>%\n  mutate(\n    start = first(GSPC.Close),\n    change = GSPC.Close - start,\n    days_from_start = as.numeric(date - first(date))\n  ) %>%\n  # 7-day rolling average\n  mutate(\n    mean_change = frollmean(change, 6),\n  ) %>%\n  ungroup()\n\nfrom_start_first_8_weeks <- from_start %>% \n  filter(days_from_start <= 7 * weeks_in_office)\n\npres_labels_end <- from_start_first_8_weeks %>%\n  group_by(name) %>% \n  filter(date == last(date))\n\np1 <- from_start_first_8_weeks %>%\n  ggplot(aes(\n    x = days_from_start,\n    y = mean_change,\n    color = time_party,\n    group = name\n  )) +\n  geom_hline(\n    yintercept = 0,\n    linetype = 2,\n    color = text,\n    alpha = 0.5\n  ) +\n  geom_line(aes(group = name),\n    size = 1.5\n  ) +\n  scale_x_continuous(\n    expand = c(0, 0),\n    limits = c(7, weeks_in_office * 7),\n    breaks = seq(7, weeks_in_office * 7, by = 7),\n    labels = c(1:8)\n  ) +\n  scale_y_continuous(\n    breaks = scales::pretty_breaks(10),\n    # limits = c(-300, 150)\n  ) +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Weeks since taking office\",\n    y = \"Change in S&P 500 since taking office\",\n    color = \"\",\n    title = \"S&P 500 during first 8 weeks of recent presidents\"\n  ) +\n  scale_color_continuous_diverging(\n    palette = \"Blue-Red\",\n    l1 = 20, l2 = 90,\n    p1 = 1, p2 = 1,\n    alpha = 1\n  ) \n\np1_labels <- p1 + \n  geom_label_repel(data=pres_labels_end,\n             aes(x=days_from_start, \n                 y=mean_change, \n                 label=name)\n             )\n\np1_labels\n\nggsave('snp-changes.png', p1_labels,\n       units='cm', \n       width = 25, \n       height = 15)\n```\n\n::: {.cell-output-display}\n![Changes in S&P 500 over the first 8 weeks of each president's term (1980 and on)](index_files/figure-html/fig-changes-1.png){#fig-changes width=768}\n:::\n:::\n\n\n\n\n\n# Now let's animate it\n\n![Animated trajectory of S&P 500 during each presidents first 8 weeks](snp-final.gif)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save the animation as a .gif file\nanim_save(\"snp-final.gif\", p1 +\n  geom_label(aes(label = name, color = time_party)) +\n  transition_reveal(days_from_start),\n  fps = 10,\n  height = 15,\n  width = 25,\n  units = \"cm\",\n  res = 180,\n  end_pause = 30,\n  renderer = gifski_renderer()\n)\n#\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}